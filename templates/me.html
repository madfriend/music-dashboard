<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My artists</title>
    <script type="text/javascript" src="https://unpkg.com/vue@2.2.1"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
    <main id="app">
        <aside>
            <ul>
                <li v-for="artist in sortedArtists">
                  (( artist ))
                </li>
            </ul>
            <input class="new-todo" autofocus autocomplete="off"
                placeholder="New artist?" v-model="newArtist"
                @keyup.enter="addArtist"/>
        </aside>
        <div class="container">
            <div v-for="artist in sortedArtists" class="card">
                (( artist ))
            </div>
        </div>
    </main>

    <script type="text/javascript">
        var artists = {{ artists|safe }};

        var app = new Vue({
            el: '#app',
            data: {
                artists: artists,
                newArtist: ''
            },
            computed: {
                sortedArtists: function() {
                    return this.artists.concat().sort();
                }
            },
            delimiters: ['((', '))'],

            methods: {
                addArtist: function() {
                    var value = this.newArtist && this.newArtist.trim();
                    if (!value) {
                        return;
                    }
                    this.artists.push(value);
                    this.saveArtist(value);
                    this.newArtist = '';
                },
                saveArtist: function(value) {
                    axios.post('/api/add', {
                        user: '{{ user }}',
                        artist: value
                    });
                }
            }
        });

    </script>
</body>
</html>